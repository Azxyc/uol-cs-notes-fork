---
title: COMP111 - Bayes' Theorem
tags: COMP111 Lectures
---
## First Form
If {% raw %}<pre>\(P(A)>0\)</pre>{% endraw %}, then:

{% raw %}<pre>\[P(B\vert A)=\frac{P(A\vert B)\times P(B)}{P(A)}\]</pre>{% endraw %}

### Proof
We have:

* {% raw %}<pre>\(P(A\cap B)=P(A\vert B)\times P(B)\)</pre>{% endraw %}
* {% raw %}<pre>\(P(A\cap B)=P(B\vert A)\times P(A)\)</pre>{% endraw %}

Thus:

{% raw %}<pre>\[P(A\vert B)\times P(B)=P(B\vert A)\times P(A)\]</pre>{% endraw %}

By dividing by {% raw %}<pre>\(P(A)\)</pre>{% endraw %} we get:

{% raw %}<pre>\[P(B\vert A)=\frac{P(A\vert B)\times P(B)}{P(A)}\]</pre>{% endraw %}

### Application - Diagnosis
Assume a patient walks into a doctor's office complaining of a stiff neck. The doctor knows:

* Meningitis may cause a patient to have a stiff neck 50% of the time.
	* Causal knowledge.
* The probability of having meningitis is {% raw %}<pre>\(\frac{1}{50000}\)</pre>{% endraw %}
* The probability of having a stiff neck is {% raw %}<pre>\(\frac{1}{20}\)</pre>{% endraw %}

What is the probability that the patient has meningitis?

Let {% raw %}<pre>\(A\)</pre>{% endraw %} be the event that the patient has a stiff neck and {% raw %}<pre>\(B\)</pre>{% endraw %} the event that they have meningitis:

{% raw %}<pre>\[P(B\vert A)=\frac{P(A\vert B)\times P(B)}{P(A)}=\frac{\frac{1}{2}\times \frac{1}{50000}}{\frac{1}{20}}=\frac{1}{5000}\]</pre>{% endraw %}

* We can interpret the fact that the patient has a stiff neck as a new **observation**.
* Given this observation, we want to **classify** that patient as either having meningitis or not having meningitis.
* We have **prior** knowledge about the **unconditional** probability of having a stiff neck.
* We have **causal** knowledge about the number of times in which meningitis causes a stiff neck.
* We can then compute the diagnostic probabilities using: 

	{% raw %}<pre>\[P(B\vert A)=\frac{P(A\vert B)\times P(B)}{P(A)}\]</pre>{% endraw %}
	
## Alternative Form
You may not have the prior probability for {% raw %}<pre>\(A\)</pre>{% endraw %} (the observation). In this case you can use other things that you might know in this alternative form.

If {% raw %}<pre>\(P(A)>0\)</pre>{% endraw %}, then:

{% raw %}<pre>\[P(B\vert A)=\frac{P(A\vert B)\times P(B)}{P(A\vert B)\times P(B)+P(A\vert \neg B)\times P(\neg B)}\]</pre>{% endraw %}

### Proof
It suffices to show:

{% raw %}<pre>\[P(A)=P(A\vert B)\times P(B)+P(A\vert \neg B) \times P(\neg B)\]</pre>{% endraw %}

But this follows from:

{% raw %}<pre>\[
\begin{aligned}
P(A)&=P((A\cap B)\cup (A\cap \neg B))\\
&=P(A\cap B)+P(A\cap\neg B)\\
&=P(A\vert B)\times P(B)+P(A\vert \neg B)\times P(\neg B)
\end{aligned}
\]</pre>{% endraw %}

### Application - Diagnosis
Assume a drug test is:

* Positive for users 99% of the time.
* Negative for non-users 99% of the time.

Assume that 0.5% take the drug.

What is the probability that a person whose test is positive (event {% raw %}<pre>\(A\)</pre>{% endraw %}) takes the drug (event {% raw %}<pre>\(B\)</pre>{% endraw %})?

We have:

* {% raw %}<pre>\(P(A\vert B)=\frac{99}{100}\)</pre>{% endraw %}
* {% raw %}<pre>\(P(\neg A\vert \neg B)=\frac{99}{100}\)</pre>{% endraw %}
* {% raw %}<pre>\(P(B)=\frac{1}{200}\)</pre>{% endraw %}

Thus:

* {% raw %}<pre>\(P(A\vert \neg B) =\frac{1}{100}\)</pre>{% endraw %}
* {% raw %}<pre>\(P(\neg B) =\frac{199}{200}\)</pre>{% endraw %}

Thus:

{% raw %}<pre>\[P(B\vert A)=\frac{P(A\vert B)\times P(B)}{P(A\vert B)\times P(B)+P(A\vert \neg B)\times P(\neg B)}=\frac{99}{298}\approx0.33\]</pre>{% endraw %}

Due to the low value it means that it is hard to take an action based on the test. This is as a result of the low value of the people who take the drug. This results in many false positives for those that don't.
