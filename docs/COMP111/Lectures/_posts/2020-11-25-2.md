---
title: COMP111 - Probabilistic Inference
tags: COMP111 Lectures
---
## Marginalisation
Given an joint distribution {% raw %}<![CDATA[\(\mathbf{P}(F_1,\ldots,F_k)\)]]>{% endraw %}, one can compute the **marginal** probabilities of the random variables {% raw %}<![CDATA[\(F_i\)]]>{% endraw %} by summing out the remaining variables.

For example:

{% raw %}<![CDATA[\[P(\text{Cavity}=1)=0.108+0.012+0.072+0.008=0.2\]]]>{% endraw %}

is the sum of the entries in the first row of:

| | {% raw %}<![CDATA[\(\text{Toothache}=1\)]]>{% endraw %} | {% raw %}<![CDATA[\(\text{Toothache}=1\)]]>{% endraw %} | {% raw %}<![CDATA[\(\text{Toothache}=0\)]]>{% endraw %} | {% raw %}<![CDATA[\(\text{Toothache}=0\)]]>{% endraw %} |
| :-: | :-: | :-: | :-: | :-: |
| | {% raw %}<![CDATA[\(\text{Catch}=1\)]]>{% endraw %} |  {% raw %}<![CDATA[\(\text{Catch}=0\)]]>{% endraw %} |  {% raw %}<![CDATA[\(\text{Catch}=1\)]]>{% endraw %} |  {% raw %}<![CDATA[\(\text{Catch}=0\)]]>{% endraw %} | 
| {% raw %}<![CDATA[\(\text{Cavity}=1\)]]>{% endraw %} | 0.108 | 0.012 | 0.072 | 0.008 |
| {% raw %}<![CDATA[\(\text{Cavity}=0\)]]>{% endraw %} | 0.016 | 0.064 | 0.144 | 0.576 |

## Conditional Distributions
We can also computer conditional distributions from the full joint distributions.

* We use the {% raw %}<![CDATA[\(\mathbf{P}\)]]>{% endraw %} notion for conditional distributions.
* {% raw %}<![CDATA[\(\mathbf{P}(F\ \vert\  G)\)]]>{% endraw %} gives the **conditional distribution of {% raw %}<![CDATA[\(F\)]]>{% endraw %} given {% raw %}<![CDATA[\(G\)]]>{% endraw %}** given by the probabilities {% raw %}<![CDATA[\(P(F=r\ \vert\  G=s)\)]]>{% endraw %} for all values {% raw %}<![CDATA[\(r\)]]>{% endraw %} and {% raw %}<![CDATA[\(s\)]]>{% endraw %}.
* Using {% raw %}<![CDATA[\(\mathbf{P}\)]]>{% endraw %} notation, the general version of the product rule is as follows:

{% raw %}<![CDATA[\[\mathbf{P}(F,G)=\mathbf{P}(F\ \vert\ G)\mathbf{P}(G)\]]]>{% endraw %}

This stands for the list of equations:

{% raw %}<![CDATA[\[
\begin{aligned}
P(F=r_1,G=s_1)&=P(F=r_1\ \vert\ G=s_1)P(G=s_1)\\
P(F=r_2,G=s_2)&=P(F=r_2\ \vert\ G=s_2)P(G=s_2)\\
\ldots&=\ldots
\end{aligned}
\]]]>{% endraw %}

## Probabilistic Inference
Probabilistic inference can be characterised as the computation of posterior probabilities:

{% raw %}<![CDATA[\[\mathbf{P}(Q\ \vert\ E_1=e_1,\ldots,E_n=e_n)\]]]>{% endraw %}

for query variable {% raw %}<![CDATA[\(Q\)]]>{% endraw %} given observed evidence {% raw %}<![CDATA[\(e_1,\ldots,e_n\)]]>{% endraw %}.

In principle, we can use the full joint distribution to do this.

### Example - {% raw %}<![CDATA[\(\mathbf{P}(\text{Cavity}\ \vert\ \text{Toothache}=1)\)]]>{% endraw %}
We want to compute the conditional probability distribution for {% raw %}<![CDATA[\(\text{Cavity}\)]]>{% endraw %} given the observation or evidence of {% raw %}<![CDATA[\(\text{Toothache}=1\)]]>{% endraw %}.

Thus we want to compute:

* {% raw %}<![CDATA[\(P(\text{Cavity}=1\ \vert\ \text{Toothache}=1)\)]]>{% endraw %}
* {% raw %}<![CDATA[\(P(\text{Cavity}=0\ \vert\ \text{Toothache}=1)\)]]>{% endraw %}

We can easily obtain this using the table:

{% raw %}<![CDATA[\[
\begin{aligned}
P(\text{Cavity}=1\ \vert\ \text{Toothache}=1)&=\frac{P(\text{Cavity}=1, \text{Toothache}=1)}{P(\text{Toothache}=1)}\\
&=\frac{0.12}{0.2}=0.6\\
\end{aligned}
\]]]>{% endraw %}

{% raw %}<![CDATA[\[
\begin{aligned}
P(\text{Cavity}=0\ \vert\ \text{Toothache}=1)&=\frac{P(\text{Cavity}=0, \text{Toothache}=1)}{P(\text{Toothache}=1)}\\
&=\frac{0.08}{0.2}=0.4
\end{aligned}
\]]]>{% endraw %}

The denominator 0.2 can be viewed as a **normalisation constant** {% raw %}<![CDATA[\(\frac{1}{\alpha}=5\)]]>{% endraw %} for the distribution {% raw %}<![CDATA[\(\mathbf{P}(\text{Cavity}\ \vert\ \text{Toothache}=1)\)]]>{% endraw %}, ensuring that is adds up to 1.

This means that instead of completing the computation above we can consider this:

{% raw %}<![CDATA[\[
\begin{aligned}
\mathbf{P}(\text{Cavity}\ \vert\ \text{Toothache}=1)&=\alpha\mathbf{P}(\text{Cavity, Toothache}=1)\\
&= \alpha(0.12,0.08)\\
&=5(0.12,0.08)\\
&= (0.6,0.4)
\end{aligned}
\]]]>{% endraw %}

In this case {% raw %}<![CDATA[\(\alpha\)]]>{% endraw %} is defined as a value that makes the sum of the vector 1. In this case it is 5.
{:.info}

### Combinatorial Explosion
This approach does not scale well: for a domain described by {% raw %}<![CDATA[\(n\)]]>{% endraw %} random variable taking {% raw %}<![CDATA[\(k\)]]>{% endraw %} distinct values each we face tow problems:

* Writing up the full joint distribution requires {% raw %}<![CDATA[\(k^n-1\)]]>{% endraw %} entries.
	* The {% raw %}<![CDATA[\(-1\)]]>{% endraw %} in this case is as the full joint distribution adds to 1. To optimise we can not calculate the last value and just take the difference of the existing values and one.
	* There are too many calculations
* How to we find the numbers (probabilities) for the entries?
	* We don't have enough raw data.

For these reasons, the full joint distribution in tabular form in not a practical tool for building reasoning systems.
